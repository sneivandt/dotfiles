# Sensitive Data Pattern Scanner Configuration
#
# This file contains regex patterns organized by category to detect sensitive
# information in staged changes, including credentials, personally identifiable
# information (PII), and other data that should not be committed.
#
# Format:
#   - INI file with [section] headers for pattern categories
#   - One pattern per line under each section
#   - Lines starting with # are comments (ignored)
#   - Empty lines are ignored
#   - Patterns are Extended Regular Expressions (ERE format for grep -E)
#   - Patterns are checked case-insensitively against added lines in diffs
#
# Pattern Guidelines:
#   - Use specific patterns to reduce false positives
#   - Include context (variable names, formatting) when possible
#   - Test patterns with: echo "sample text" | grep -iE "pattern"
#
# Section Organization:
#   - Each section groups related patterns by service or credential type
#   - Easy to enable/disable entire categories if needed
#   - Helps understand what types of secrets are being scanned
#
# Bypassing Detection:
#   If the hook produces false positives, use: git commit --no-verify
#   Only bypass when you're certain no sensitive data is present.

# Generic API Keys and Secrets
# Matches: apikey = "abc123...", api_key: "xyz789...", secret_key = "def456..."
[api-keys]
(apikey|api_key|api-key)[[:space:]]*[=:][[:space:]]*["'][A-Za-z0-9_\-]{16,}["']
(secret|secret_key|secret-key)[[:space:]]*[=:][[:space:]]*["'][A-Za-z0-9_\-]{16,}["']
(token|auth_token|access_token|api_token)[[:space:]]*[=:][[:space:]]*["'][A-Za-z0-9_\-\.]{16,}["']

# Password Patterns
# Matches: password = "passw0rd", passwd: "secret123"
[passwords]
(password|passwd|pwd)[[:space:]]*[=:][[:space:]]*["'][^"']{8,}["']

# Bearer Tokens and Authorization Headers
# Matches: bearer = "token...", authorization: "Bearer abc..."
[tokens]
(bearer|authorization)[[:space:]]*[=:][[:space:]]*[A-Za-z0-9_\-\.]{20,}

# AWS Credentials
# Matches: AWS access key IDs (AKIA...), secret keys, and credential variables
[aws]
(aws_access_key_id|aws_secret_access_key)[[:space:]]*[=:]
AKIA[0-9A-Z]{16}

# Private Keys (PEM format)
# Matches: -----BEGIN RSA PRIVATE KEY-----, -----BEGIN OPENSSH PRIVATE KEY-----, etc.
[private-keys]
-----BEGIN[A-Z ]*PRIVATE KEY-----
-----BEGIN RSA PRIVATE KEY-----
-----BEGIN DSA PRIVATE KEY-----
-----BEGIN EC PRIVATE KEY-----
-----BEGIN OPENSSH PRIVATE KEY-----

# GitHub Personal Access Tokens
# Format: ghp_ (classic), gho_ (OAuth), ghu_ (user-to-server), ghs_ (server-to-server), ghr_ (refresh)
[github]
gh[pousr]_[A-Za-z0-9_]{36,}

# GitLab Personal Access Tokens
# Format: glpat- followed by 20+ alphanumeric/dash characters
[gitlab]
glpat-[A-Za-z0-9_\-]{20,}

# OAuth Client Secrets
# Matches: client_secret = "abc...", client-secret: "xyz..."
[oauth]
(client_secret|client-secret)\s*[=:]\s*["'][A-Za-z0-9_\-]{16,}["']

# Database Connection Strings
# Matches: mysql://user:pass@host, postgresql://user:pass@host, mongodb://user:pass@host
[database]
(mysql|postgresql|mongodb|postgres)://[^:]+:[^@]+@
jdbc:[^:]+://[^:]+:[^@]+@

# Slack Tokens
# Format: xoxp- (user), xoxb- (bot), xoxa- (app), xoxo- (legacy)
[slack]
xox[pboa]-[0-9]{10,13}-[0-9]{10,13}-[A-Za-z0-9]{20,}

# Stripe API Keys
# Format: sk_test_, sk_live_ (secret), pk_test_, pk_live_ (publishable)
[stripe]
(sk|pk)_(test|live)_[0-9a-zA-Z]{24,}

# Google Cloud and Firebase API Keys
# Format: AIza followed by 35 alphanumeric/underscore/dash characters
[google]
AIza[0-9A-Za-z_\-]{35}

# Heroku API Keys
# Matches UUID format in Heroku-related context to reduce false positives
[heroku]
(heroku|HEROKU)[^=:]*[=:][^0-9a-fA-F]*[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}

# Personally Identifiable Information (PII)
# Email addresses - Matches standard email format (user@domain.tld)
# Phone numbers - US formats: (123) 456-7890, 123-456-7890, 1234567890, +1-123-456-7890
# SSN - US Social Security Numbers: 123-45-6789, 123456789
# Credit Cards - Common formats with/without spaces/dashes (Visa, MC, Amex, Discover)
# IP Addresses - IPv4 and IPv6 formats for network-related PII
[pii]
[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}
\+?1?[[:space:]\-\.]?\(?[0-9]{3}\)?[[:space:]\-\.]?[0-9]{3}[[:space:]\-\.]?[0-9]{4}
[0-9]{3}[\-]?[0-9]{2}[\-]?[0-9]{4}
\b([0-9]{4}[[:space:]\-]?){3}[0-9]{4}\b
(^|[^0-9])([0-9]{1,3}\.){3}[0-9]{1,3}([^0-9]|$)
([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}

# Generic High-Entropy Secrets
# Matches variable names containing key/secret/password/token with long random-looking values
# This is a catch-all for patterns that don't fit other categories
[generic]
(key|secret|password|token|auth|credential)\s*[=:]\s*["'][A-Za-z0-9+/=_\-]{32,}["']
