#!/usr/bin/env bash
# Performance profiling helper for bash startup
# To profile bash startup, set BASH_PROFILE_STARTUP=1 before running bash
#   Example: BASH_PROFILE_STARTUP=1 bash -ic exit

# Convenient function to profile shell startup
bash-profile() {
  local logfile
  # Use mktemp to create secure temporary file
  logfile=$(mktemp "${TMPDIR:-/tmp}/bash-profile.XXXXXX.log")
  PS4='+ $(date "+%s.%N") ' bash -x -i -c "exit" 2>"$logfile"
  echo "Profile log saved to: $logfile"
  echo "Showing last 30 lines (most recent operations):"
  grep -E "^\+" "$logfile" | tail -30
  echo ""
  echo "To view full log: less $logfile"
  echo "To delete log: rm $logfile"
}

alias bash-startup-time='for i in {1..10}; do /usr/bin/time -f "%E elapsed" bash -ic exit 2>&1 | grep elapsed; done'
